import _t from"@monaco-editor/loader";import{memo as Te}from"react";import ke,{useState as re,useRef as k,useCallback as oe,useEffect as ne}from"react";import Pe from"@monaco-editor/loader";import{memo as Ee}from"react";import K from"react";var ae={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},v=ae;import me from"react";var le={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Y=le;function Me({children:e}){return me.createElement("div",{style:Y.container},e)}var Z=Me;var $=Z;function ye({width:e,height:r,isEditorReady:n,loading:t,_ref:d,className:a,wrapperProps:E}){return K.createElement("section",{style:{...v.wrapper,width:e,height:r},...E},!n&&K.createElement($,null,t),K.createElement("div",{ref:d,style:{...v.fullWidth,...!n&&v.hide},className:a}))}var ee=ye;var H=Ee(ee);import{useEffect as xe}from"react";function ge(e){xe(e,[])}var D=ge;import{useEffect as Ce,useRef as Re}from"react";function he(e,r,n=!0){let t=Re(!0);Ce(t.current||!n?()=>{t.current=!1}:e,r)}var p=he;function R(){}function b(e,r,n,t){return De(e,t)||be(e,r,n,t)}function De(e,r){return e.editor.getModel(te(e,r))}function be(e,r,n,t){return e.editor.createModel(r,n,t?te(e,t):void 0)}function te(e,r){return e.Uri.parse(r)}function Se({original:e,modified:r,language:n,originalLanguage:t,modifiedLanguage:d,originalModelPath:a,modifiedModelPath:E,keepCurrentOriginalModel:P=!1,keepCurrentModifiedModel:N=!1,theme:x="light",loading:I="Loading...",options:M={},height:V="100%",width:z="100%",className:F,wrapperProps:j={},beforeMount:A=R,onMount:q=R}){let[l,S]=re(!1),[T,c]=re(!0),m=k(null),s=k(null),O=k(null),u=k(q),o=k(A),h=k(!1);D(()=>{let i=Pe.init();return i.then(y=>(s.current=y)&&c(!1)).catch(y=>y?.type!=="cancelation"&&console.error("Monaco initialization: error:",y)),()=>m.current?w():i.cancel()}),p(()=>{let i=m.current.getModifiedEditor();i.getOption(s.current.editor.EditorOption.readOnly)?i.setValue(r||""):r!==i.getValue()&&(i.executeEdits("",[{range:i.getModel().getFullModelRange(),text:r||"",forceMoveMarkers:!0}]),i.pushUndoStop())},[r],l),p(()=>{m.current?.getModel()?.original.setValue(e||"")},[e],l),p(()=>{let{original:i,modified:y}=m.current.getModel();s.current.editor.setModelLanguage(i,t||n||"text"),s.current.editor.setModelLanguage(y,d||n||"text")},[n,t,d],l),p(()=>{s.current?.editor.setTheme(x)},[x],l),p(()=>{m.current?.updateOptions(M)},[M],l);let L=oe(()=>{if(!s.current)return;o.current(s.current);let i=b(s.current,e||"",t||n||"text",a||""),y=b(s.current,r||"",d||n||"text",E||"");m.current?.setModel({original:i,modified:y})},[n,r,d,e,t,a,E]),U=oe(()=>{!h.current&&O.current&&(m.current=s.current.editor.createDiffEditor(O.current,{automaticLayout:!0,...M}),L(),s.current?.editor.setTheme(x),S(!0),h.current=!0)},[M,x,L]);ne(()=>{l&&u.current(m.current,s.current)},[l]),ne(()=>{!T&&!l&&U()},[T,l,U]);function w(){let i=m.current?.getModel();P||i?.original?.dispose(),N||i?.modified?.dispose(),m.current?.dispose()}return ke.createElement(H,{width:z,height:V,isEditorReady:l,loading:I,_ref:O,className:F,wrapperProps:j})}var ie=Se;var Oe=Te(ie);import{useState as we}from"react";import ce from"@monaco-editor/loader";function Ie(){let[e,r]=we(ce.__getMonacoInstance());return D(()=>{let n;return e||(n=ce.init(),n.then(t=>{r(t)})),()=>n?.cancel()}),e}var Le=Ie;import{memo as ze}from"react";import We,{useState as ue,useEffect as W,useRef as g,useCallback as _e}from"react";import Ne from"@monaco-editor/loader";import{useEffect as Ue,useRef as ve}from"react";function He(e){let r=ve();return Ue(()=>{r.current=e},[e]),r.current}var se=He;var _=new Map;function Ve({defaultValue:e,defaultLanguage:r,defaultPath:n,value:t,language:d,path:a,theme:E="light",line:P,loading:N="Loading...",options:x={},overrideServices:I={},saveViewState:M=!0,keepCurrentModel:V=!1,width:z="100%",height:F="100%",className:j,wrapperProps:A={},beforeMount:q=R,onMount:l=R,onChange:S,onValidate:T=R}){let[c,m]=ue(!1),[s,O]=ue(!0),u=g(null),o=g(null),h=g(null),L=g(l),U=g(q),w=g(),i=g(t),y=se(a),Q=g(!1),B=g(!1);D(()=>{let f=Ne.init();return f.then(C=>(u.current=C)&&O(!1)).catch(C=>C?.type!=="cancelation"&&console.error("Monaco initialization: error:",C)),()=>o.current?pe():f.cancel()}),p(()=>{let f=b(u.current,e||t||"",r||d||"",a||n||"");f!==o.current?.getModel()&&(M&&_.set(y,o.current?.saveViewState()),o.current?.setModel(f),M&&o.current?.restoreViewState(_.get(a)))},[a],c),p(()=>{o.current?.updateOptions(x)},[x],c),p(()=>{!o.current||t===void 0||(o.current.getOption(u.current.editor.EditorOption.readOnly)?o.current.setValue(t):t!==o.current.getValue()&&(B.current=!0,o.current.executeEdits("",[{range:o.current.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),o.current.pushUndoStop(),B.current=!1))},[t],c),p(()=>{let f=o.current?.getModel();f&&d&&u.current?.editor.setModelLanguage(f,d)},[d],c),p(()=>{P!==void 0&&o.current?.revealLine(P)},[P],c),p(()=>{u.current?.editor.setTheme(E)},[E],c);let X=_e(()=>{if(!(!h.current||!u.current)&&!Q.current){U.current(u.current);let f=a||n,C=b(u.current,t||e||"",r||d||"",f||"");o.current=u.current?.editor.create(h.current,{model:C,automaticLayout:!0,...x},I),M&&o.current.restoreViewState(_.get(f)),u.current.editor.setTheme(E),m(!0),Q.current=!0}},[e,r,n,t,d,a,x,I,M,E]);W(()=>{c&&L.current(o.current,u.current)},[c]),W(()=>{!s&&!c&&X()},[s,c,X]),i.current=t,W(()=>{c&&S&&(w.current?.dispose(),w.current=o.current?.onDidChangeModelContent(f=>{B.current||S(o.current.getValue(),f)}))},[c,S]),W(()=>{if(c){let f=u.current.editor.onDidChangeMarkers(C=>{let G=o.current.getModel()?.uri;if(G&&C.find(J=>J.path===G.path)){let J=u.current.editor.getModelMarkers({resource:G});T?.(J)}});return()=>{f?.dispose()}}return()=>{}},[c,T]);function pe(){w.current?.dispose(),V?M&&_.set(a,o.current.saveViewState()):o.current.getModel()?.dispose(),o.current.dispose()}return We.createElement(H,{width:z,height:F,isEditorReady:c,loading:N,_ref:h,className:j,wrapperProps:A})}var fe=Ve;var de=ze(fe);var Ft=de;export{Oe as DiffEditor,de as Editor,Ft as default,_t as loader,Le as useMonaco};
//# sourceMappingURL=index.mjs.map