{"version":3,"file":"rbac.js","sources":["../../../src/rbac/rbac.ts"],"sourcesContent":["import { WithAccessControlMetadata } from '../types/accesscontrol';\nimport { CurrentUserDTO } from '../types/config';\n\nexport interface CurrentUser extends Omit<CurrentUserDTO, 'lightTheme'> {}\n\nexport function userHasPermission(action: string, user: CurrentUser): boolean {\n  return !!user.permissions?.[action];\n}\n\nexport function userHasPermissionInMetadata(action: string, object: WithAccessControlMetadata): boolean {\n  return !!object.accessControl?.[action];\n}\n\nexport function userHasAllPermissions(actions: string[], user: CurrentUser) {\n  return actions.every((action) => userHasPermission(action, user));\n}\n\nexport function userHasAnyPermission(actions: string[], user: CurrentUser) {\n  return actions.some((action) => userHasPermission(action, user));\n}\n"],"names":[],"mappings":"AAKgB,SAAA,iBAAA,CAAkB,QAAgB,IAA4B,EAAA;AAL9E,EAAA,IAAA,EAAA,CAAA;AAME,EAAA,OAAO,CAAC,EAAA,CAAC,EAAK,GAAA,IAAA,CAAA,WAAA,KAAL,IAAmB,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,MAAA,CAAA,CAAA,CAAA;AAC9B,CAAA;AAEgB,SAAA,2BAAA,CAA4B,QAAgB,MAA4C,EAAA;AATxG,EAAA,IAAA,EAAA,CAAA;AAUE,EAAA,OAAO,CAAC,EAAA,CAAC,EAAO,GAAA,MAAA,CAAA,aAAA,KAAP,IAAuB,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,MAAA,CAAA,CAAA,CAAA;AAClC,CAAA;AAEgB,SAAA,qBAAA,CAAsB,SAAmB,IAAmB,EAAA;AAC1E,EAAA,OAAO,QAAQ,KAAM,CAAA,CAAC,WAAW,iBAAkB,CAAA,MAAA,EAAQ,IAAI,CAAC,CAAA,CAAA;AAClE,CAAA;AAEgB,SAAA,oBAAA,CAAqB,SAAmB,IAAmB,EAAA;AACzE,EAAA,OAAO,QAAQ,IAAK,CAAA,CAAC,WAAW,iBAAkB,CAAA,MAAA,EAAQ,IAAI,CAAC,CAAA,CAAA;AACjE;;;;"}